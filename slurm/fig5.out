/bin/bash: /home/mts247/.conda/envs/rag/lib/libtinfo.so.6: no version information available (required by /bin/bash)
bash: /home/mts247/.conda/envs/rag/lib/libtinfo.so.6: no version information available (required by bash)
bash: /home/mts247/.conda/envs/rag/lib/libtinfo.so.6: no version information available (required by bash)
rm: cannot remove '*.csv': No such file or directory
rm: cannot remove '*.pdf': No such file or directory
Performance of Matmul with K=12288, N=12288
32, 12288, 12288, 0.0954ms, 101.2549Tflops
64, 12288, 12288, 0.0958ms, 201.6946Tflops
128, 12288, 12288, 0.1449ms, 266.6851Tflops
256, 12288, 12288, 0.2689ms, 287.5128Tflops
512, 12288, 12288, 0.5168ms, 299.1963Tflops
1024, 12288, 12288, 1.0126ms, 305.4014Tflops
2048, 12288, 12288, 2.0041ms, 308.6015Tflops
4096, 12288, 12288, 3.9872ms, 310.2269Tflops
8192, 12288, 12288, 7.9535ms, 311.0460Tflops
16384, 12288, 12288, 15.8860ms, 311.4572Tflops
32768, 12288, 12288, 31.7510ms, 311.6632Tflops
Performance of Matmul with M=8192, N=K
8192, 32, 32, 0.0213ms, 0.7892Tflops
8192, 64, 64, 0.0215ms, 3.1190Tflops
8192, 128, 128, 0.0220ms, 12.1814Tflops
8192, 256, 256, 0.0244ms, 43.9285Tflops
8192, 512, 512, 0.0348ms, 123.5191Tflops
8192, 1024, 1024, 0.0761ms, 225.7932Tflops
8192, 2048, 2048, 0.2413ms, 284.7332Tflops
8192, 4096, 4096, 0.9024ms, 304.6117Tflops
8192, 8192, 8192, 3.5466ms, 310.0228Tflops
8192, 16384, 16384, 14.1232ms, 311.4057Tflops
8192, 32768, 32768, 56.4298ms, 311.7534Tflops
Performance of Matmul with K=12288, N=12288
32, 12288, 12288, 0.4395ms, 21.9864Tflops
64, 12288, 12288, 0.4412ms, 43.8026Tflops
128, 12288, 12288, 0.7375ms, 52.4151Tflops
256, 12288, 12288, 1.3649ms, 56.6392Tflops
512, 12288, 12288, 2.6199ms, 59.0173Tflops
1024, 12288, 12288, 5.1298ms, 60.2828Tflops
2048, 12288, 12288, 10.1496ms, 60.9362Tflops
4096, 12288, 12288, 20.1891ms, 61.2682Tflops
8192, 12288, 12288, 40.2682ms, 61.4356Tflops
16384, 12288, 12288, 80.4265ms, 61.5196Tflops
32768, 12288, 12288, 160.7429ms, 61.5617Tflops
Performance of Matmul with M=8192, N=K
8192, 32, 32, 0.1111ms, 0.1510Tflops
8192, 64, 64, 0.1123ms, 0.5977Tflops
8192, 128, 128, 0.1146ms, 2.3426Tflops
8192, 256, 256, 0.1274ms, 8.4261Tflops
8192, 512, 512, 0.1797ms, 23.8982Tflops
8192, 1024, 1024, 0.3889ms, 44.1782Tflops
8192, 2048, 2048, 1.2255ms, 56.0744Tflops
8192, 4096, 4096, 4.5720ms, 60.1217Tflops
8192, 8192, 8192, 17.9581ms, 61.2265Tflops
8192, 16384, 16384, 71.5024ms, 61.5091Tflops
8192, 32768, 32768, 285.6796ms, 61.5801Tflops
Performance of Matmul with K=12288, N=12288
32, 12288, 12288, 0.1169ms, 82.6921Tflops
64, 12288, 12288, 0.1516ms, 127.4625Tflops
128, 12288, 12288, 0.2813ms, 137.4325Tflops
256, 12288, 12288, 0.5405ms, 143.0261Tflops
512, 12288, 12288, 1.0591ms, 145.9972Tflops
1024, 12288, 12288, 2.0961ms, 147.5296Tflops
2048, 12288, 12288, 4.1702ms, 148.3079Tflops
4096, 12288, 12288, 8.3184ms, 148.7001Tflops
8192, 12288, 12288, 16.6149ms, 148.8970Tflops
16384, 12288, 12288, 33.2077ms, 148.9956Tflops
32768, 12288, 12288, 66.3934ms, 149.0450Tflops
Performance of Matmul with M=8192, N=K
8192, 32, 32, 0.0223ms, 0.7514Tflops
8192, 64, 64, 0.0227ms, 2.9618Tflops
8192, 128, 128, 0.0238ms, 11.2786Tflops
8192, 256, 256, 0.0292ms, 36.7698Tflops
8192, 512, 512, 0.0508ms, 84.5349Tflops
8192, 1024, 1024, 0.1372ms, 125.1920Tflops
8192, 2048, 2048, 0.4829ms, 142.3021Tflops
8192, 4096, 4096, 1.8657ms, 147.3363Tflops
8192, 8192, 8192, 7.3966ms, 148.6509Tflops
8192, 16384, 16384, 29.5204ms, 148.9833Tflops
8192, 32768, 32768, 118.0156ms, 149.0666Tflops
Performance of Matmul with K=12288, N=12288
32, 12288, 12288, 0.1713ms, 56.4149Tflops
64, 12288, 12288, 0.1731ms, 111.6803Tflops
128, 12288, 12288, 0.1796ms, 215.1782Tflops
256, 12288, 12288, 0.3132ms, 246.8333Tflops
512, 12288, 12288, 0.5776ms, 267.7001Tflops
1024, 12288, 12288, 1.1229ms, 275.3847Tflops
2048, 12288, 12288, 2.2160ms, 279.0908Tflops
4096, 12288, 12288, 4.4022ms, 280.9815Tflops
8192, 12288, 12288, 8.7747ms, 281.9365Tflops
16384, 12288, 12288, 17.5195ms, 282.4165Tflops
32768, 12288, 12288, 35.0092ms, 282.6570Tflops
Performance of Matmul with M=8192, N=K
8192, 32, 32, 0.0216ms, 0.7751Tflops
8192, 64, 64, 0.0224ms, 2.9934Tflops
8192, 128, 128, 0.0242ms, 11.0761Tflops
8192, 256, 256, 0.0289ms, 37.1884Tflops
8192, 512, 512, 0.0437ms, 98.2161Tflops
8192, 1024, 1024, 0.0955ms, 179.9848Tflops
8192, 2048, 2048, 0.2827ms, 243.0601Tflops
8192, 4096, 4096, 0.9882ms, 278.1646Tflops
8192, 8192, 8192, 3.7941ms, 289.7980Tflops
8192, 16384, 16384, 15.1653ms, 290.0066Tflops
8192, 32768, 32768, 60.7264ms, 289.6957Tflops
Performance of Matmul with K=12288, N=12288
32, 12288, 12288, 0.7861ms, 12.2935Tflops
64, 12288, 12288, 0.7944ms, 24.3285Tflops
128, 12288, 12288, 0.8131ms, 47.5375Tflops
256, 12288, 12288, 1.4792ms, 52.2628Tflops
512, 12288, 12288, 2.8354ms, 54.5316Tflops
1024, 12288, 12288, 5.5477ms, 55.7416Tflops
2048, 12288, 12288, 10.9723ms, 56.3669Tflops
4096, 12288, 12288, 21.8215ms, 56.6848Tflops
8192, 12288, 12288, 43.5200ms, 56.8452Tflops
16384, 12288, 12288, 86.9169ms, 56.9257Tflops
32768, 12288, 12288, 173.7107ms, 56.9660Tflops
Performance of Matmul with M=8192, N=K
8192, 32, 32, 0.1511ms, 0.1110Tflops
8192, 64, 64, 0.1362ms, 0.4929Tflops
8192, 128, 128, 0.1451ms, 1.8496Tflops
8192, 256, 256, 0.1632ms, 6.5798Tflops
8192, 512, 512, 0.2187ms, 19.6375Tflops
8192, 1024, 1024, 0.4691ms, 36.6232Tflops
8192, 2048, 2048, 1.3905ms, 49.4215Tflops
8192, 4096, 4096, 4.9217ms, 55.8499Tflops
8192, 8192, 8192, 19.0693ms, 57.6588Tflops
8192, 16384, 16384, 76.0673ms, 57.8178Tflops
8192, 32768, 32768, 304.2057ms, 57.8299Tflops
Performance of Matmul with K=12288, N=12288
32, 12288, 12288, 0.2140ms, 45.1554Tflops
64, 12288, 12288, 0.2181ms, 88.6294Tflops
128, 12288, 12288, 0.3502ms, 110.3832Tflops
256, 12288, 12288, 0.6764ms, 114.2987Tflops
512, 12288, 12288, 1.3288ms, 116.3624Tflops
1024, 12288, 12288, 2.6335ms, 117.4225Tflops
2048, 12288, 12288, 5.2431ms, 117.9598Tflops
4096, 12288, 12288, 10.4622ms, 118.2303Tflops
8192, 12288, 12288, 20.9004ms, 118.3661Tflops
16384, 12288, 12288, 41.7769ms, 118.4340Tflops
32768, 12288, 12288, 83.5297ms, 118.4681Tflops
Performance of Matmul with M=8192, N=K
8192, 32, 32, 0.0232ms, 0.7234Tflops
8192, 64, 64, 0.0242ms, 2.7748Tflops
8192, 128, 128, 0.0274ms, 9.7900Tflops
8192, 256, 256, 0.0360ms, 29.8131Tflops
8192, 512, 512, 0.0647ms, 66.3579Tflops
8192, 1024, 1024, 0.1690ms, 101.6724Tflops
8192, 2048, 2048, 0.5950ms, 115.4891Tflops
8192, 4096, 4096, 2.3265ms, 118.1506Tflops
8192, 8192, 8192, 9.2853ms, 118.4137Tflops
8192, 16384, 16384, 37.1718ms, 118.3168Tflops
8192, 32768, 32768, 148.8200ms, 118.2112Tflops
bash: /home/mts247/.conda/envs/rag/lib/libtinfo.so.6: no version information available (required by bash)
rm: cannot remove '*.csv': No such file or directory
rm: cannot remove '*.pdf': No such file or directory
Performance of Softmax
4096, 32, 10.582530939519842
4096, 64, 20.525878711243987
4096, 128, 38.71347005373559
4096, 256, 69.50859156936976
4096, 512, 115.41127322318003
4096, 1024, 172.305600632343
4096, 2048, 228.66914710614682
4096, 4096, 273.3827948525364
4096, 8192, 303.00764177735493
4096, 16384, 320.3656920374149
4096, 32768, 329.8124863167622
32, 4096, 10.582530939519842
64, 4096, 20.525878711243987
128, 4096, 38.71347005373559
256, 4096, 69.50859156936976
512, 4096, 115.41127322318003
1024, 4096, 172.305600632343
2048, 4096, 228.66914710614682
4096, 4096, 273.3827948525364
8192, 4096, 303.00764177735493
16384, 4096, 320.3656920374149
32768, 4096, 329.8124863167622
Performance of Softmax
4096, 32, 0.42683221550911815
4096, 64, 0.8344237958498132
4096, 128, 1.5968645341904715
4096, 256, 2.9400964062425428
4096, 512, 5.074242411762284
4096, 1024, 7.965069657691438
4096, 2048, 11.137669099866663
4096, 4096, 13.907432167398023
4096, 8192, 15.882267142546384
4096, 16384, 17.0960760048045
4096, 32768, 17.775319076033174
32, 4096, 0.42683221550911815
64, 4096, 0.8344237958498132
128, 4096, 1.5968645341904715
256, 4096, 2.9400964062425428
512, 4096, 5.074242411762284
1024, 4096, 7.965069657691438
2048, 4096, 11.137669099866663
4096, 4096, 13.907432167398023
8192, 4096, 15.882267142546384
16384, 4096, 17.0960760048045
32768, 4096, 17.775319076033174
Performance of Softmax
4096, 32, 5.702987942413188
4096, 64, 10.938125884583545
4096, 128, 20.21767565833313
4096, 256, 35.1113301759424
4096, 512, 55.585146986480304
4096, 1024, 78.46085696840542
4096, 2048, 98.78880606576776
4096, 4096, 113.49060320456485
4096, 8192, 122.61436746797759
4096, 16384, 127.74939784870256
4096, 32768, 130.4816520753914
32, 4096, 5.702987942413188
64, 4096, 10.938125884583545
128, 4096, 20.21767565833313
256, 4096, 35.1113301759424
512, 4096, 55.585146986480304
1024, 4096, 78.46085696840542
2048, 4096, 98.78880606576776
4096, 4096, 113.49060320456485
8192, 4096, 122.61436746797759
16384, 4096, 127.74939784870256
32768, 4096, 130.4816520753914
Performance of Softmax
4096, 32, 10.49826857532379
4096, 64, 20.257757316672144
4096, 128, 37.8479459348761
4096, 256, 66.94856728853469
4096, 512, 108.84070671378092
4096, 1024, 158.39856010284979
4096, 2048, 205.08265908381594
4096, 4096, 240.33684073637585
4096, 8192, 257.7791230058408
4096, 16384, 264.85447324962354
4096, 32768, 263.1690879255967
32, 4096, 9.939095641698575
64, 4096, 19.00766430114162
128, 4096, 35.081913439635535
256, 4096, 63.12407821706089
512, 4096, 105.14843609985063
1024, 4096, 153.92141585549945
2048, 4096, 203.49489505195788
4096, 4096, 240.33684073637585
8192, 4096, 261.6279342608773
16384, 4096, 274.4683083491902
32768, 4096, 282.1280717488789
Performance of Softmax
4096, 32, 0.42343774272261747
4096, 64, 0.8219270051567369
4096, 128, 1.552388980237254
4096, 256, 2.7938724581483814
4096, 512, 4.656484894295501
4096, 1024, 6.98864798369228
4096, 2048, 9.323430706473543
4096, 4096, 11.1931459881472
4096, 8192, 12.440556956633207
4096, 16384, 13.173164357758893
4096, 32768, 13.575578325587061
32, 4096, 0.4232370116932548
64, 4096, 0.8215488431019539
128, 4096, 1.5517144620344832
256, 4096, 2.792780025614
512, 4096, 4.656484894295501
1024, 4096, 6.98864798369228
2048, 4096, 9.323430706473543
4096, 4096, 11.1931459881472
8192, 4096, 12.440556956633207
16384, 4096, 13.174677518457026
32768, 4096, 13.575578325587061
Performance of Softmax
4096, 32, 5.661682762025238
4096, 64, 10.807196913925617
4096, 128, 19.80847928754554
4096, 256, 33.96119002452228
4096, 512, 52.836395047509356
4096, 1024, 72.72398692162885
4096, 2048, 88.53545624509982
4096, 4096, 96.9237026277565
4096, 8192, 90.93482825905164
4096, 16384, 74.9661760012256
4096, 32768, 63.108505962072734
32, 4096, 5.2927833862128635
64, 4096, 10.039435386803808
128, 4096, 18.190007930214115
256, 4096, 31.925675264233835
512, 4096, 51.291233709514
1024, 4096, 70.16903589694564
2048, 4096, 85.99416554390486
4096, 4096, 96.9237026277565
8192, 4096, 103.50099763810061
16384, 4096, 107.13615647065264
32768, 4096, 109.05120295655242
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:63: PerformanceWarning: indexing past lexsort depth may impact performance.
  softmax_TPUv3_sim.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:66: PerformanceWarning: indexing past lexsort depth may impact performance.
  softmax_TPUv3_roofline.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:68: PerformanceWarning: indexing past lexsort depth may impact performance.
  throughput_GPU_list.append(softmax_A100.loc[(M, N), "throughput"].values[0])
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:69: PerformanceWarning: indexing past lexsort depth may impact performance.
  throughput_GPU_sim_list.append(softmax_A100_sim.loc[(M, N), "throughput"].values[0])
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:71: PerformanceWarning: indexing past lexsort depth may impact performance.
  softmax_A100_roofline.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:73: PerformanceWarning: indexing past lexsort depth may impact performance.
  throughput_AMD_list.append(softmax_MI210.loc[(M, N), "throughput"].values[0])
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:75: PerformanceWarning: indexing past lexsort depth may impact performance.
  softmax_MI210_sim.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:78: PerformanceWarning: indexing past lexsort depth may impact performance.
  softmax_MI210_roofline.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:164: PerformanceWarning: indexing past lexsort depth may impact performance.
  softmax_TPUv3_sim.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:167: PerformanceWarning: indexing past lexsort depth may impact performance.
  softmax_TPUv3_roofline.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:169: PerformanceWarning: indexing past lexsort depth may impact performance.
  throughput_GPU_list.append(softmax_A100.loc[(M, N), "throughput"].values[0])
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:170: PerformanceWarning: indexing past lexsort depth may impact performance.
  throughput_GPU_sim_list.append(softmax_A100_sim.loc[(M, N), "throughput"].values[0])
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:172: PerformanceWarning: indexing past lexsort depth may impact performance.
  softmax_A100_roofline.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:174: PerformanceWarning: indexing past lexsort depth may impact performance.
  throughput_AMD_list.append(softmax_MI210.loc[(M, N), "throughput"].values[0])
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:176: PerformanceWarning: indexing past lexsort depth may impact performance.
  softmax_MI210_sim.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/cf/plot_softmax.py:179: PerformanceWarning: indexing past lexsort depth may impact performance.
  softmax_MI210_roofline.loc[(M, N), "throughput"].values[0]
bash: /home/mts247/.conda/envs/rag/lib/libtinfo.so.6: no version information available (required by bash)
rm: cannot remove '*.csv': No such file or directory
rm: cannot remove '*.pdf': No such file or directory
Performance of LayerNorm
4096, 32, 2.8961624411319686
4096, 64, 5.75960150501097
4096, 128, 11.390503139448523
4096, 256, 22.283084658956984
4096, 512, 42.69960922518389
4096, 1024, 78.79859244742593
4096, 2048, 136.49708117741687
4096, 4096, 215.33369869437396
4096, 8192, 302.7687785757934
4096, 16384, 379.89616719883327
4096, 32768, 435.3462721912106
32, 4096, 2.8961624411319686
64, 4096, 5.75960150501097
128, 4096, 11.390503139448523
256, 4096, 22.283084658956984
512, 4096, 42.69960922518389
1024, 4096, 78.79859244742593
2048, 4096, 136.49708117741687
4096, 4096, 215.33369869437396
8192, 4096, 302.7687785757934
16384, 4096, 379.89616719883327
32768, 4096, 435.3462721912106
Performance of LayerNorm
4096, 32, 0.9212481316162515
4096, 64, 1.8134790818879194
4096, 128, 3.5162058282627364
4096, 256, 6.627649522300616
4096, 512, 11.886952457122964
4096, 1024, 19.705501026373003
4096, 2048, 29.3617201370433
4096, 4096, 38.890379904496854
4096, 8192, 46.42315461190709
4096, 16384, 51.40116450632734
4096, 32768, 54.313198851478525
32, 4096, 0.9212481316162515
64, 4096, 1.8134790818879194
128, 4096, 3.5162058282627364
256, 4096, 6.627649522300616
512, 4096, 11.886952457122964
1024, 4096, 19.705501026373003
2048, 4096, 29.3617201370433
4096, 4096, 38.890379904496854
8192, 4096, 46.42315461190709
16384, 4096, 51.40116450632734
32768, 4096, 54.313198851478525
Performance of LayerNorm
4096, 32, 2.861922695738355
4096, 64, 5.691937540423173
4096, 128, 11.258011695906431
4096, 256, 22.029564025389636
4096, 512, 42.234186305596026
4096, 1024, 78.0062869654681
4096, 2048, 134.13705550137223
4096, 4096, 209.5146009140185
4096, 8192, 289.9501698820876
4096, 16384, 298.43319922943874
4096, 32768, 239.15005603213626
32, 4096, 2.861922695738355
64, 4096, 5.691937540423173
128, 4096, 11.258011695906431
256, 4096, 22.029564025389636
512, 4096, 42.234186305596026
1024, 4096, 78.0062869654681
2048, 4096, 134.13705550137223
4096, 4096, 209.5146009140185
8192, 4096, 292.76347813172936
16384, 4096, 365.350155756504
32768, 4096, 416.35022039961456
Performance of LayerNorm
4096, 32, 0.8833484850657453
4096, 64, 1.714098415392535
4096, 128, 3.235538281752649
4096, 256, 5.696740530105999
4096, 512, 9.193316606818078
4096, 1024, 13.263290587364597
4096, 2048, 17.033810420807054
4096, 4096, 19.856193392425464
4096, 8192, 21.649803744989292
4096, 16384, 22.67386928142163
4096, 32768, 23.22311187029701
32, 4096, 0.9007067768111705
64, 4096, 1.7357350351492613
128, 4096, 3.235538281752649
256, 4096, 5.696740530105999
512, 4096, 9.193316606818078
1024, 4096, 13.263290587364597
2048, 4096, 17.033810420807054
4096, 4096, 19.856193392425464
8192, 4096, 21.649803744989292
16384, 4096, 22.67386928142163
32768, 4096, 23.22311187029701
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/de/plot_layernorm.py:47: PerformanceWarning: indexing past lexsort depth may impact performance.
  layernorm_TPUv3_sim.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/de/plot_layernorm.py:50: PerformanceWarning: indexing past lexsort depth may impact performance.
  layernorm_TPUv3_roofline.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/de/plot_layernorm.py:52: PerformanceWarning: indexing past lexsort depth may impact performance.
  throughput_GPU_list.append(layernorm_A100.loc[(M, N), "throughput"].values[0])
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/de/plot_layernorm.py:54: PerformanceWarning: indexing past lexsort depth may impact performance.
  layernorm_A100_sim.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/de/plot_layernorm.py:57: PerformanceWarning: indexing past lexsort depth may impact performance.
  layernorm_A100_roofline.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/de/plot_layernorm.py:121: PerformanceWarning: indexing past lexsort depth may impact performance.
  layernorm_TPUv3_sim.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/de/plot_layernorm.py:124: PerformanceWarning: indexing past lexsort depth may impact performance.
  layernorm_TPUv3_roofline.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/de/plot_layernorm.py:126: PerformanceWarning: indexing past lexsort depth may impact performance.
  throughput_GPU_list.append(layernorm_A100.loc[(M, N), "throughput"].values[0])
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/de/plot_layernorm.py:128: PerformanceWarning: indexing past lexsort depth may impact performance.
  layernorm_A100_sim.loc[(M, N), "throughput"].values[0]
/home/mts247/CSL-Research/LLM-Modeling/LLMCompass/ae/figure5/de/plot_layernorm.py:131: PerformanceWarning: indexing past lexsort depth may impact performance.
  layernorm_A100_roofline.loc[(M, N), "throughput"].values[0]
bash: /home/mts247/.conda/envs/rag/lib/libtinfo.so.6: no version information available (required by bash)
rm: cannot remove '*.csv': No such file or directory
rm: cannot remove '*.pdf': No such file or directory
Performance of GELU
1024, 0.02275453977881386
2048, 0.045507048185507756
4096, 0.09100597197052188
8192, 0.1819794550402402
16384, 0.36382902404316175
32768, 0.7271390597695807
65536, 1.4522066018480209
131072, 2.8961624411319686
262144, 5.75960150501097
524288, 11.390503139448523
1048576, 22.283084658956984
2097152, 42.69960922518389
4194304, 78.79859244742593
8388608, 136.49708117741687
16777216, 215.33369869437396
33554432, 302.7687785757934
67108864, 379.89616719883327
134217728, 435.3462721912106
268435456, 469.6193790606159
536870912, 488.86249375238543
Performance of GELU
1024, 0.010237277319861737
2048, 0.02046911217437533
4096, 0.04091647183846971
8192, 0.08174607218683651
16384, 0.1631457627118644
32768, 0.32491476793248947
65536, 0.6443916317991631
131072, 1.2675687242798355
262144, 2.45433625498008
524288, 4.614519850187265
1048576, 8.241316387959866
2097152, 13.576603856749312
4194304, 20.074571079429735
8388608, 26.389864524765727
16777216, 31.31569308975377
33554432, 34.53916565922032
67108864, 36.41326030939736
134217728, 37.428700700130534
268435456, 37.95795905890848
536870912, 38.228241165954614
Performance of GELU
1024, 0.04875001904297619
2048, 0.09747627823385169
4096, 0.19485758650611215
8192, 0.38933584779401703
16384, 0.7771588166542706
32768, 1.5483012534587297
65536, 3.0728142957883846
131072, 6.052635467616331
262144, 11.749688042340185
524288, 22.19542923716759
1048576, 39.95659013035155
2097152, 66.60636427388127
4194304, 99.93214446367442
8388608, 133.2730036553684
16777216, 159.95655476875484
33554432, 177.750956496975
67108864, 188.22025828373873
134217728, 193.93141317852005
268435456, 196.91896273388596
536870912, 198.44752327029548
Performance of GELU
1024, 0.022737982253056812
2048, 0.045475964506113624
4096, 0.09095192901222725
8192, 0.1819038580244545
16384, 0.36352697715328536
32768, 0.7264933423964187
65536, 1.4507494164396844
131072, 2.8903725453980025
262144, 5.741117577240345
524288, 11.318436424006554
1048576, 22.00893997967342
2097152, 41.70418339223893
4194304, 75.47412612244479
8388608, 126.88729358789831
16777216, 192.3520534437588
33554432, 259.22206849126434
67108864, 313.8115610444997
134217728, 350.7111134612391
268435456, 372.6362755947159
536870912, 384.66003725992067
Performance of GELU
1024, 0.010237277319861737
2048, 0.02046911217437533
4096, 0.04091647183846971
8192, 0.08174607218683651
16384, 0.1631457627118644
32768, 0.32491476793248947
65536, 0.6443916317991631
131072, 1.2675687242798355
262144, 2.45433625498008
524288, 4.614519850187265
1048576, 8.241316387959866
2097152, 13.576603856749312
4194304, 20.074571079429735
8388608, 26.389864524765727
16777216, 31.31569308975377
33554432, 34.53916565922032
67108864, 36.41326030939736
134217728, 37.428700700130534
268435456, 37.95795905890848
536870912, 38.228241165954614
Performance of GELU
1024, 0.04866326729847448
2048, 0.09732653459694895
4096, 0.1946530691938979
8192, 0.38852022467829733
16384, 0.7754749554207382
32768, 1.5447256309861017
65536, 3.0587626583882077
131072, 5.998357731996506
262144, 11.546856751641094
524288, 21.52011823230415
1048576, 37.820072869791105
2097152, 60.87388644399195
4194304, 87.6388350103441
8388608, 112.33434104756213
16777216, 130.757196212743
33554432, 142.41131672221218
67108864, 149.06783695578403
134217728, 152.63503305101366
268435456, 154.47964451158177
536870912, 155.41877113504603
bash: /home/mts247/.conda/envs/rag/lib/libtinfo.so.6: no version information available (required by bash)
rm: cannot remove '*.csv': No such file or directory
rm: cannot remove '*.pdf': No such file or directory
bash: /home/mts247/.conda/envs/rag/lib/libtinfo.so.6: no version information available (required by bash)
rm: cannot remove '*.csv': No such file or directory
rm: cannot remove '*.pdf': No such file or directory
Auto-regression
Roofline breakdown:
0.00011872086709171161
5.8340186365865625e-05
5.8340186365865625e-05
3.957362236390387e-05
9.514985384992643e-05
9.514985384992643e-05
1.3736192251103482e-05
4.519284747425209e-05
4.519284747425209e-05
4.519284747425209e-05
2.8066e-05
2.8066e-05

total:
0.00046527456988719956
0.00010412188719960766
4.519284747425209e-05
5.6132e-05

Auto-regression
Roofline breakdown:
0.00045365366912722535
0.00019264941380807643
0.00019264941380807643
0.00015121788970907512
0.0002742312809379071
0.0002742312809379071
0.00031593710106382974
0.00014085370386452453
0.00014085370386452453
0.00010127659574468085
0.0009050676184615382
0.0009050676184615382

total:
0.0015386329483282673
0.0005976445087928787
0.00010127659574468085
0.0018101352369230765

Initial computation
Roofline breakdown:
0.011961734751773048
0.0006820408195429471
0.0006820408195429471
0.003987244917257683
0.01588597966903073
0.01588597966903073
0.0023817097636096123
0.00043995162726826874
0.00043995162726826874
0.00043995162726826874
0.0027006292
0.0027006292

total:
0.04908502064617809
0.0032616130181461495
0.00043995162726826874
0.0054012584

Initial computation
Roofline breakdown:
0.030448672340425538
0.0017832595744680852
0.0017832595744680852
0.010149557446808512
0.040268229787234044
0.040268229787234044
0.02205237446808511
0.001888385514546244
0.001888385514546244
0.0027144680851063827
0.011276063999999999
0.011276063999999999

total:
0.12470120851063832
0.025829145497177596
0.0027144680851063827
0.022552127999999998

Auto-regression
Auto-regression
Initial computation
simulating qkv
simulating q_mul_k
simulating a_mul_v
simulating h_matmul0
simulating h1_matmul1
simulating h2_matmul2
finish matmul simulation
Initial computation
simulating qkv
simulating q_mul_k
simulating a_mul_v
simulating h_matmul0
simulating h1_matmul1
simulating h2_matmul2
finish matmul simulation
[0.0132067468085106, 0.0015258622247312, 0.0009140380645776, 0.0050027312056737, 0.0175195255319148, 0.0175195255319148, 0.0027685489361702, 0.0004610439716312, 0.0004610439716312, 0.0005515177227886, 0.0027006292, 0.0027006292]
gpu prefilling: 0.9787949749639931, 0.8717643180359945
0.875670988687527 0.6037655687491426
4.4662743226490225 3.6436227827417556
